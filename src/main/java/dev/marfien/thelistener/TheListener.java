package dev.marfien.thelistener;

import com.github.tomaslanger.chalk.Ansi;

import java.util.HashSet;
import java.util.Random;
import java.util.Set;

public class TheListener {

    private static final String SMILY = 
                            "                        @@@@@@@@@@@@@@@@                        \n" +
                            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
                            "               @@@@@@@@@@@            @@@@@@@@@@@               \n" +
                            "             @@@@@@@@                      @@@@@@@@             \n" +
                            "          @@@@@@@                              @@@@@@@          \n" +
                            "        @@@@@@%                                  %@@@@@@        \n" +
                            "       @@@@@=                                      =@@@@@       \n" +
                            "      @@@@@                                          @@@@@      \n" +
                            "    @@@@@                                              @@@@@    \n" +
                            "   @@@@@                                                @@@@@   \n" +
                            "  @@@@@                                                  @@@@@  \n" +
                            "  @@@@             @@@@                  @@@@             @@@@  \n" +
                            " @@@@.            @@@@@@                @@@@@@            .@@@@ \n" +
                            " @@@@             @@@@@@                @@@@@@             @@@@ \n" +
                            "@@@@.             @@@@@@                @@@@@@             .@@@@\n" +
                            "@@@@              @@@@@@                @@@@@@              @@@@\n" +
                            "@@@@                                                        @@@@\n" +
                            "@@@@                                                        @@@@\n" +
                            "@@@@                                                        @@@@\n" +
                            "@@@@                                                        @@@@\n" +
                            "@@@@                                                        @@@@\n" +
                            " @@@@                                                      @@@@ \n" +
                            " @@@@.            @@@@                    @@@@            .@@@@ \n" +
                            "  @@@@            @@@@@@@%            %@@@@@@@            @@@@  \n" +
                            "  @@@@@             *@@@@@@@@@@@@@@@@@@@@@@#             @@@@@  \n" +
                            "   @@@@@                %@@@@@@@@@@@@@@%                @@@@@   \n" +
                            "    @@@@@                                              @@@@@    \n" +
                            "     @@@@@@                                          @@@@@@     \n" +
                            "       @@@@@                                        @@@@@       \n" +
                            "        @@@@@@+                                  +@@@@@@        \n" +
                            "          @@@@@@@                              @@@@@@@          \n" +
                            "            @@@@@@@@#                      *@@@@@@@@            \n" +
                            "               @@@@@@@@@@@            @@@@@@@@@@@               \n" +
                            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
                            "                        @@@@@@@@@@@@@@@@                        \n" +
                            "\n";

    private static final String OKKK = 
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "               @@@@@@@@@@@%          %@@@@@@@@@@@               \n" +
            "             @@@@@@@@                      @@@@@@@@             \n" +
            "          @@@@@@@:                            :@@@@@@@          \n" +
            "        @@@@@@@                                  @@@@@@@        \n" +
            "       @@@@@@                                      @@@@@@       \n" +
            "      @@@@@                                          @@@@@      \n" +
            "    @@@@@:                           ============     :@@@@@    \n" +
            "   @@@@@                           ================     @@@@@   \n" +
            "  @@@@@                            -===        ===-      @@@@@  \n" +
            "  @@@@.                                                  .@@@@  \n" +
            " @@@@@                                                    @@@@@ \n" +
            " @@@@         :============:             @@@@              @@@@ \n" +
            "@@@@%         ==============            @@@@@@             %@@@@\n" +
            "@@@@.             @@@@@@                @@@@@@             .@@@@\n" +
            "@@@@              @@@@@@                @@@@@@              @@@@\n" +
            "@@@@              @@@@@@                @@@@@@              @@@@\n" +
            "@@@@               :@@.                  .@@:               @@@@\n" +
            "@@@@.                                                      .@@@@\n" +
            "@@@@%                                                      %@@@@\n" +
            " @@@@                                                      @@@@ \n" +
            " @@@@%                                                    %@@@@ \n" +
            "  @@@@.                                                  .@@@@  \n" +
            "  @@@@@                 @@@@@@@@@@@@@@@@                 @@@@@  \n" +
            "   @@@@@                @@@@@@@@@@@@@@@@                @@@@@   \n" +
            "    @@@@@:                                            :@@@@@    \n" +
            "     @@@@@@                                          @@@@@@     \n" +
            "       @@@@@%                                      %@@@@@       \n" +
            "        @@@@@@@                                  @@@@@@@        \n" +
            "          @@@@@@@.                            .@@@@@@@          \n" +
            "            @@@@@@@@@                      @@@@@@@@@            \n" +
            "               @@@@@@@@@@@+          +@@@@@@@@@@@               \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "\n";

    private static final String OHH = 
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "               @@@@@@@@@@@%          %@@@@@@@@@@@               \n" +
            "             @@@@@@@@                      @@@@@@@@             \n" +
            "          @@@@@@@:                            :@@@@@@@          \n" +
            "        @@@@@@@                                  @@@@@@@        \n" +
            "       @@@@@@                                      @@@@@@       \n" +
            "      @@@@@                                          @@@@@      \n" +
            "    @@@@@:                                            :@@@@@    \n" +
            "   @@@@@                                                @@@@@   \n" +
            "  @@@@@                                                  @@@@@  \n" +
            "  @@@@.           .@@@@.                .@@@@.           .@@@@  \n" +
            " @@@@@            @@@@@@                @@@@@@            @@@@@ \n" +
            " @@@@             @@@@@@                @@@@@@             @@@@ \n" +
            "@@@@%             @@@@@@                @@@@@@             %@@@@\n" +
            "@@@@.             @@@@@@                @@@@@@             .@@@@\n" +
            "@@@@                ::                    ::                @@@@\n" +
            "@@@@                                                        @@@@\n" +
            "@@@@                                                        @@@@\n" +
            "@@@@.                                                      .@@@@\n" +
            "@@@@%                                                      %@@@@\n" +
            " @@@@                       @@@@@@@@                       @@@@ \n" +
            " @@@@%                    :@@@@@@@@@@:                    %@@@@ \n" +
            "  @@@@.                   @@@@@@@@@@@@                   .@@@@  \n" +
            "  @@@@@                   @@@@@@@@@@@@                   @@@@@  \n" +
            "   @@@@@                  @@@@@@@@@@@@                  @@@@@   \n" +
            "    @@@@@:                #@@@@@@@@@@#                :@@@@@    \n" +
            "     @@@@@@                .@@@@@@@@.                @@@@@@     \n" +
            "       @@@@@%                 .:-.                 %@@@@@       \n" +
            "        @@@@@@@                                  @@@@@@@        \n" +
            "          @@@@@@@.                            .@@@@@@@          \n" +
            "            @@@@@@@@@                      @@@@@@@@@            \n" +
            "               @@@@@@@@@@@+          +@@@@@@@@@@@               \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "\n";

    private static final String THINKING = 
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "               @@@@@@@@@@@%          %@@@@@@@@@@@               \n" +
            "             @@@@@@@@                      @@@@@@@@             \n" +
            "          @@@@@@@:                            :@@@@@@@          \n" +
            "        @@@@@@@        ..:.          .:..        @@@@@@@        \n" +
            "       @@@@@@     ==========        ==========     @@@@@@       \n" +
            "      @@@@@    ============          ============    @@@@@      \n" +
            "    @@@@@:   ======-                        -======   :@@@@@    \n" +
            "   @@@@@    =====                              =====    @@@@@   \n" +
            "  @@@@@      --                                  --      @@@@@  \n" +
            "  @@@@.           .@@@@.                                 .@@@@  \n" +
            " @@@@@            @@@@@@             @@@@@@@@             @@@@@ \n" +
            " @@@@             @@@@@@            @@@@@@@@@@             @@@@ \n" +
            "@@@@%             @@@@@@            @@@@@@@@@@             %@@@@\n" +
            "@@@@.             @@@@@@                                   .@@@@\n" +
            "@@@@                ::                                      @@@@\n" +
            "@@@@                                                        @@@@\n" +
            "@@@@                                 .::::::                @@@@\n" +
            "@@@@.                         *@@@@@@@@@@@@@@@             .@@@@\n" +
            "@@@@%                      @@@@@@@@@@@@@@@@@@=             %@@@@\n" +
            " @@@@     :====:         @@@@@@@-                          @@@@ \n" +
            " @@@@%    ======       =@@@@@.                            %@@@@ \n" +
            "  @@@@.   =========================                      .@@@@  \n" +
            "  @@@@@   ==========================                     @@@@@  \n" +
            "   @@@@@  =========================:                    @@@@@   \n" +
            "    @@@@@:================                            :@@@@@    \n" +
            "     @@@@@================                           @@@@@@     \n" +
            "      @@@@================                         %@@@@@       \n" +
            "      @@@@================                       @@@@@@@        \n" +
            "      @@@@================                    .@@@@@@@          \n" +
            "      @@@@@@============:                  @@@@@@@@@            \n" +
            "       @@@@@@@@@@@@@@@@@@@+          +@@@@@@@@@@@               \n" +
            "          @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "\n";

    private static final String SWEAT_SMILE = 
            "                        @@@@@@@@@@@@@@@@             @@         \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@       @@@@        \n" +
            "               @@@@@@@@@@@%          %@@@@@@@@@@@  @@@@@@       \n" +
            "             @@@@@@@@                      @@@@@@@@@@@@@@@      \n" +
            "          @@@@@@@:                            :@@@@@@@@@@@@     \n" +
            "        @@@@@@@                                  @@@@==@@@@@    \n" +
            "       @@@@@@                                      @====@@@@@   \n" +
            "      @@@@@                                        ======@@@@@  \n" +
            "    @@@@@:                                        ========@@@@@ \n" +
            "   @@@@@                                         ==========@@@@@\n" +
            "  @@@@@                                         ============@@@@\n" +
            "  @@@@.                                         ============@@@@\n" +
            " @@@@@                                           ==========@@@@@\n" +
            " @@@@            .@@@@@@.              .@@@@@@.   :======- @@@@ \n" +
            "@@@@%          :@@@@@@@@@@=          =@@@@@@@@@@:          %@@@@\n" +
            "@@@@.         *@@@      @@@%        %@@@      @@@*         .@@@@\n" +
            "@@@@          @@:        =@@        @@=        :@@          @@@@\n" +
            "@@@@          %%          %%        %%          %%          @@@@\n" +
            "@@@@                                                        @@@@\n" +
            "@@@@.                                                      .@@@@\n" +
            "@@@@%                                                      %@@@@\n" +
            " @@@@           @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@           @@@@ \n" +
            " @@@@%          @@                            @@          %@@@@ \n" +
            "  @@@@.          @@                          @@          .@@@@  \n" +
            "  @@@@@          #@@@@@@@@@@@@@@@@@@@@@@@@@@@@#          @@@@@  \n" +
            "   @@@@@          *@@@@@@@@@@@@@@@@@@@@@@@@@@*          @@@@@   \n" +
            "    @@@@@:          @@@@@@@@@@%%%%@@@@@@@@@@          :@@@@@    \n" +
            "     @@@@@@          :@@@@@%%%%%%%%%%@@@@@:          @@@@@@     \n" +
            "       @@@@@%           %@@@@@@@@@@@@@@%           %@@@@@       \n" +
            "        @@@@@@@             .:#@@#:.             @@@@@@@        \n" +
            "          @@@@@@@.                            .@@@@@@@          \n" +
            "            @@@@@@@@@                      @@@@@@@@@            \n" +
            "               @@@@@@@@@@@+          +@@@@@@@@@@@               \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "\n";

    private static final String OHH2 = 
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "               @@@@@@@@@@@%          %@@@@@@@@@@@               \n" +
            "             @@@@@@@@                      @@@@@@@@             \n" +
            "          @@@@@@@:                            :@@@@@@@          \n" +
            "        @@@@@@@                                  @@@@@@@        \n" +
            "       @@@@@@                                      @@@@@@       \n" +
            "      @@@@@                                          @@@@@      \n" +
            "    @@@@@:                                            :@@@@@    \n" +
            "   @@@@@           -========        ========-           @@@@@   \n" +
            "  @@@@@        .===========-        -===========.        @@@@@  \n" +
            "  @@@@.      -======-                      -======-      .@@@@  \n" +
            " @@@@@      ======                            ======      @@@@@ \n" +
            " @@@@       -==-                                -==:       @@@@ \n" +
            "@@@@%                                                      %@@@@\n" +
            "@@@@.              =@@=                  =@@=              .@@@@\n" +
            "@@@@              @@@@@@                @@@@@@              @@@@\n" +
            "@@@@              @@@@@@                @@@@@@              @@@@\n" +
            "@@@@              @@@@@@                @@@@@@              @@@@\n" +
            "@@@@.             @@@@@@                @@@@@@             .@@@@\n" +
            "@@@@%              @@@@                  @@@@              %@@@@\n" +
            " @@@@                                                      @@@@ \n" +
            " @@@@%                      #@@@@@@#                      %@@@@ \n" +
            "  @@@@.                    @@@@@@@@@@                    .@@@@  \n" +
            "  @@@@@                   @@@@@@@@@@@@                   @@@@@  \n" +
            "   @@@@@                  @@@@@@@@@@@@                  @@@@@   \n" +
            "    @@@@@:                #@@@@@@@@@@#                :@@@@@    \n" +
            "     @@@@@@                .@@@@@@@@.                @@@@@@     \n" +
            "       @@@@@%                 .:-.                 %@@@@@       \n" +
            "        @@@@@@@                                  @@@@@@@        \n" +
            "          @@@@@@@.                            .@@@@@@@          \n" +
            "            @@@@@@@@@                      @@@@@@@@@            \n" +
            "               @@@@@@@@@@@+          +@@@@@@@@@@@               \n" +
            "                   @@@@@@@@@@@@@@@@@@@@@@@@@@                   \n" +
            "                        @@@@@@@@@@@@@@@@                        \n" +
            "\n";

    private static final String[] EMOTENS = {OKKK, OHH, OHH2, THINKING, SWEAT_SMILE};
    private static final int smilyRows = SMILY.split("\n").length;

    private static final Random random = new Random();
    private static final Set<Integer> lastEmotens = new HashSet<>();

    public static void main(String[] args) throws InterruptedException {
        setup();
        while (true) {
            System.out.print(Ansi.cursorUp(smilyRows + 1));

            printSmily();

            System.out.print(Ansi.cursorDown());
            System.out.print("\r");

            Thread.sleep(1500);
        }
    }

    private static void setup() {
        for (int i = 0; i < smilyRows - 1; i++) System.out.println();
        System.out.print(Ansi.eraseScreen());
        System.out.print(Ansi.setCursorPosition(0, 0));
    }

    private static void printSmily() {
        if (lastEmotens.size() > 2 || random.nextDouble() > 0.2) {
            printSmily(-1);
            lastEmotens.clear();
        } else {
            int index;
            do {
                index = random.nextInt(EMOTENS.length);
            } while (!lastEmotens.add(index));
            printSmily(index);
        }
    }

    private static void printSmily(int index) {
        String[] split = (index == -1 ? SMILY : EMOTENS[index]).split("\n");
        for (int j = 0; j < split.length; j++) {
            System.out.print(Ansi.cursorDown());
            System.out.print(Ansi.eraseLine());
            String line = split[j];
            System.out.print("\r                 " + Ansi.Color.GREEN.getStart() + line + Ansi.Color.GREEN.getEnd());
        }
    }

}
